# /system/bin/bootpwn
# Boot into chroot environment

# Export chroot directory into variable
export NEW_ROOT=/data/local/kali

echo "[+] Mounting filesystems..."

# Remount system partition with rw flag set
mount -o remount,rw -t yaffs /dev/block/mtdblock3 /system

echo "[+] Filesystems mounted."

sysctl -w net.ipv4.ip_forward=1 &> /dev/null

# Setup environment variables for shell environment
export HOME=/root
export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/pwnix/bin:$PATH
export TERM=xterm-color
export TZ=America/New_York

echo "[!] Welcome to the Pwn zone. Get your game face on."

stty columns 85
stty rows 46

# Mount USB OTG drive for copying files to/from chroot environment
# This might go in chrootboot
chroot $NEW_ROOT /bin/cp /proc/mounts /etc/mtab

# Drop user to bash shell
chroot $NEW_ROOT "$@"
